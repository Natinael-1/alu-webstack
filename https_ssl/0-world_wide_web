#!/usr/bin/env bash
# Displays DNS records for a domain and its subdomains

domain="$1"
subdomain="$2"

get_record() {
    local full="$1.$domain"
    # dig output -> find "ANSWER SECTION" -> read the next line -> extract record type + destination
    dig "$full" | awk '/ANSWER SECTION/{getline; print}' | awk '{print $4, $5}'
}

print_output() {
    local sub="$1"
    local result
    result=$(get_record "$sub")
    local record_type
    local destination

    record_type=$(echo "$result" | awk '{print $1}')
    destination=$(echo "$result" | awk '{print $2}')

    echo "The subdomain $sub is a $record_type record and points to $destination"
}

if [ -z "$subdomain" ]; then
    # Print all four in fixed order
    print_output "www"
    print_output "lb-01"
    print_output "web-01"
    print_output "web-02"
else
    # Only print the requested subdomain
    print_output "$subdomain"
fi
